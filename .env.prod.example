# ==============================================
# Pressograph Production Environment
# ==============================================
# SECURITY CRITICAL: This file contains production configuration
# 
# IMPORTANT:
# 1. NEVER commit actual .env.prod with real secrets to version control
# 2. Generate ALL secrets using: task secrets:generate
# 3. Use strong, unique passwords for each service
# 4. Rotate secrets regularly (every 90 days recommended)
# 5. Enable all security features (TLS, rate limiting, etc.)

# ----------------------------------------------
# Application
# ----------------------------------------------
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://pressograph.com
NEXT_TELEMETRY_DISABLED=1

# ----------------------------------------------
# Database (PostgreSQL 18)
# ----------------------------------------------
# CRITICAL: Use strong password in production
# Format: postgresql://user:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://pressograph:GENERATE_STRONG_PASSWORD@db:5432/pressograph?sslmode=require

POSTGRES_USER=pressograph
POSTGRES_PASSWORD=GENERATE_STRONG_PASSWORD
POSTGRES_DB=pressograph
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Connection pooling (tuned for production)
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20

# ----------------------------------------------
# Cache (Valkey 9)
# ----------------------------------------------
REDIS_URL=redis://:GENERATE_REDIS_PASSWORD@cache:6379
REDIS_DB=0

# REQUIRED in production
VALKEY_PASSWORD=GENERATE_REDIS_PASSWORD

# ----------------------------------------------
# Authentication (NextAuth.js)
# ----------------------------------------------
# CRITICAL: Use your production domain
NEXTAUTH_URL=https://pressograph.com

# CRITICAL: Generate with openssl rand -hex 32
NEXTAUTH_SECRET=GENERATE_WITH_SCRIPT_64_CHARS_MIN

# Session duration: 30 days
NEXTAUTH_SESSION_MAX_AGE=2592000

# ----------------------------------------------
# Application Secrets
# ----------------------------------------------
# CRITICAL: All secrets must be cryptographically random
# Generate with: openssl rand -hex 32

# General application secret (256-bit)
APP_SECRET=GENERATE_WITH_SCRIPT_64_CHARS_MIN

# JWT signing secret (256-bit)
JWT_SECRET=GENERATE_WITH_SCRIPT_64_CHARS_MIN

# API authentication key (256-bit)
API_SECRET_KEY=GENERATE_WITH_SCRIPT_64_CHARS_MIN

# Data encryption key (256-bit for AES-256)
ENCRYPTION_KEY=GENERATE_WITH_SCRIPT_64_CHARS_MIN

# ----------------------------------------------
# Email / SMTP (REQUIRED for production)
# ----------------------------------------------
# Use production email service (SendGrid, AWS SES, etc.)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=CONFIGURE_YOUR_SMTP_USER
SMTP_PASSWORD=CONFIGURE_YOUR_SMTP_PASSWORD
SMTP_FROM=noreply@pressograph.com
SMTP_FROM_NAME=Pressograph

# ----------------------------------------------
# Object Storage (S3 compatible)
# ----------------------------------------------
# Use AWS S3, DigitalOcean Spaces, or similar
S3_BUCKET=pressograph-production
S3_REGION=us-east-1
S3_ENDPOINT=https://s3.amazonaws.com
S3_ACCESS_KEY=CONFIGURE_YOUR_S3_ACCESS_KEY
S3_SECRET_KEY=CONFIGURE_YOUR_S3_SECRET_KEY
S3_PUBLIC_URL=https://cdn.pressograph.com

# ----------------------------------------------
# External Services (Production)
# ----------------------------------------------
# Analytics (Google Analytics, Plausible, etc.)
ANALYTICS_ID=CONFIGURE_YOUR_ANALYTICS_ID

# Error tracking (Sentry)
SENTRY_DSN=https://xxx@sentry.io/xxx
SENTRY_ENVIRONMENT=production

# Search (Meilisearch, Elasticsearch, etc.)
MEILISEARCH_HOST=https://search.pressograph.com
MEILISEARCH_API_KEY=GENERATE_MEILISEARCH_KEY

# ----------------------------------------------
# Feature Flags (Production settings)
# ----------------------------------------------
ENABLE_SIGNUP=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_TWO_FACTOR=true

# ----------------------------------------------
# Rate Limiting (REQUIRED in production)
# ----------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=900000  # 15 minutes in milliseconds

# Strict rate limits for sensitive endpoints
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_WINDOW=300000  # 5 minutes

# ----------------------------------------------
# Security (Production)
# ----------------------------------------------
# CORS origins (strict whitelist)
ALLOWED_ORIGINS=https://pressograph.com,https://www.pressograph.com

# Content Security Policy
CSP_ENABLED=true

# HTTPS enforcement
FORCE_HTTPS=true

# ----------------------------------------------
# Logging and Monitoring
# ----------------------------------------------
# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Disable debug logging in production
DEBUG=

# Application Performance Monitoring
# APM_SERVER_URL=https://apm.example.com
# APM_SECRET_TOKEN=

# ----------------------------------------------
# Backup and Disaster Recovery
# ----------------------------------------------
# Database backup settings
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
# BACKUP_RETENTION_DAYS=30
# BACKUP_S3_BUCKET=pressograph-backups

# ----------------------------------------------
# Infrastructure
# ----------------------------------------------
# For Kubernetes/container orchestration
# POD_NAME=${HOSTNAME}
# POD_NAMESPACE=production
# POD_IP=

# Health check endpoints
HEALTH_CHECK_PATH=/api/health
READINESS_CHECK_PATH=/api/ready

# ----------------------------------------------
# PRODUCTION DEPLOYMENT CHECKLIST
# ----------------------------------------------
# Before deploying to production, ensure:
# □ All GENERATE_* placeholders replaced with real values
# □ Database password is strong (32+ characters)
# □ All secrets are unique and cryptographically random
# □ SMTP credentials configured and tested
# □ S3/storage credentials configured
# □ HTTPS/TLS certificates are valid
# □ Rate limiting enabled
# □ Email verification enabled
# □ Error tracking (Sentry) configured
# □ Backups configured and tested
# □ Monitoring and alerts set up
# □ This file is NOT committed to version control
