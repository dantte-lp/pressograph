# Release Notes - v1.0.2

**Release Date:** 2025-10-28
**Type:** PATCH - Setup Improvements & Build Optimization
**Status:** PRODUCTION

## 📋 Summary

Patch release focusing on database initialization improvements, backend Dockerfile migration from Alpine to Debian, and enhanced setup page with database metrics display.

## 🎯 Key Features

### 🔧 Setup & Database

**New Features:**
- Added database size display in Setup page Database Schema section
- Added schema version display in Setup page (tracks database migration version)
- Enhanced setup status endpoint to return database size (`pg_size_pretty`) and schema version

**Fixed Issues:**
- Fixed initialization error when database tables already exist but are empty
- Fixed migration logic to only run when tables don't exist (prevents "relation already exists" error)
- Improved initialization flow: check connection → check tables → run migrations only if needed

### 🏗️ Build System

**Container Changes:**
- Migrated backend Dockerfile from `node:22-alpine` to `node:22-trixie-slim` for consistency
- Updated package manager from `apk` (Alpine) to `apt-get` (Debian)
- Updated user creation commands to use Debian syntax (`groupadd`/`useradd` instead of `addgroup`/`adduser`)
- Changed to buildah-based builds (using `buildah bud`) instead of `podman build`

**Technical Details:**
- Backend: `server/Dockerfile`
  - Multi-stage build now uses `node:22-trixie-slim` in both stages
  - Proper cleanup of apt lists to reduce image size: `rm -rf /var/lib/apt/lists/*`
- Frontend: `deploy/Containerfile`
  - Already using `node:22-trixie-slim` and `nginx:1.29-trixie-perl`

## 📦 What's Changed

### API Changes

**Setup Endpoint Enhancements:**
- `GET /api/v1/setup/status` now returns:
  - `schema.size` - Database size in human-readable format (e.g., "9110 kB")
  - `schema.version` - Current schema version from app_settings table

**Example Response:**
```json
{
  "success": true,
  "initialized": true,
  "userCount": 1,
  "database": { ... },
  "schema": {
    "tables": [...],
    "tableCount": 7,
    "totalRows": 5,
    "size": "9110 kB",
    "version": "initial"
  }
}
```

### UI Changes

**Setup Page:**
- Database Schema section now displays information in 2x2 grid:
  - Tables count
  - Total rows
  - **Database size** (new)
  - **Schema version** (new)

## 🔄 Breaking Changes

⚠️ **None**

## 📚 Migration Guide

No migration required. This is a patch release with backward-compatible changes.

## 🐛 Known Issues

None currently reported.

## 📊 Statistics

- **Commits:** 3
- **Files Changed:** 5
- **Insertions:** +150
- **Deletions:** -50

## 🔗 Links

- [GitHub Release](https://github.com/dantte-lp/pressograph/releases/tag/v1.0.2)
- [Full Changelog](https://github.com/dantte-lp/pressograph/compare/v1.0.1...v1.0.2)

---

**Full Changelog:** https://github.com/dantte-lp/pressograph/commits/v1.0.2
